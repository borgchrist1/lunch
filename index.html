<!DOCTYPEhtml>
<html>
<head>
    <title>Lunch</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    <style>
    .top-buffer {
        margin-top: 15px;
    }
    .padding {
        padding-right: 20px;
    }
    .display-none {
        display: none;
    }
    .display {
        display: block;
    }
    </style>
</head>
<body>
    <div class="container top-buffer">
        <div class="row">
            <div class="col-md-4">
                <h1>Dagens Lunch</h1>
                <div class="form-group">
                    <input class="form-control addNew" type="text" placeholder="Add your lunch spot">
                    <button class="btn btn-success top-buffer submitSpot">Add lunch spot</button>
                </div>
                <div class="form-group showNewAlts">

                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="form-inline addToDiv">
                    <div class="form-controll padding">
                        Select all
                        <input class="checkbox all" type="checkbox" value="Select all">
                    </div>
                    <div class="form-controll padding">
                        Äran
                        <input class="checkbox checkboxes" type="checkbox" checked value="Äran">
                    </div>
                    <div class="form-controll padding">
                        Kebab
                        <input class="checkbox checkboxes" type="checkbox" checked value="Kebab">
                    </div>
                    <div class="form-controll padding">
                        Korv
                        <input class="checkbox checkboxes" type="checkbox" checked value="Korv">
                    </div>
                    <div class="form-controll padding">
                        Indiskt
                        <input class="checkbox checkboxes" type="checkbox"checked value="Indiskt">
                    </div>
                    <div class="form-controll padding">
                        Pizza
                        <input class="checkbox checkboxes" type="checkbox" checked value="Pizza">
                    </div>
                    <div class="form-controll padding">
                        Thai
                        <input class="checkbox checkboxes" type="checkbox" checked value="Thai">
                    </div>
                    <div class="form-controll padding">
                        Siencepark
                        <input class="checkbox checkboxes" type="checkbox" checked value="Siencepark">
                    </div>
                    <div class="form-controll padding">
                        Ericsson
                        <input class="checkbox checkboxes" type="checkbox" checked value="Ericsson">
                    </div>
                    <div class="form-controll padding">
                        E.A.T.
                        <input class="checkbox checkboxes" type="checkbox" value="E.A.T.">
                    </div>
                    <div class="form-controll padding">
                        Mat låda
                        <input class="checkbox checkboxes" type="checkbox" value="Mat låda">
                    </div>
                </div>
                <div class="form-group top-buffer">
                    <button class="btn btn-info random-lunch display">Get lunch?</button>
                    <button class="btn btn-danger reloadAlts-lunch display-none">reload</button>
                    <div class="top-buffer">
                        <h3 class="food"></h3>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
<script>
    const checkboxes = document.querySelectorAll('.checkboxes');
    const btnRandomLunch = document.querySelector('.random-lunch');
    const reloadAlts = document.querySelector('.reloadAlts-lunch');
    const result = document.querySelector('.food');
    const all = document.querySelector('.all');
    const alt = [];
    const addNewSpotInput = document.querySelector('.addNew');
    const addNewSpot = document.querySelector('.submitSpot')
    const newAlts = document.querySelector('.showNewAlts');

    // add new lunch spots
    addNewSpot.addEventListener('click', (event) => {
        event.preventDefault();
        alt.push(addNewSpotInput.value);
        newAlts.innerHTML += `<div class="form-controll">${addNewSpotInput.value}<input class="checkbox checkboxes" type="checkbox" checked value="${addNewSpotInput.value}"></div>`;
        addNewSpotInput.value = null;
    });

    // check all boxes
    // TODO: Array dose not update when run
    all.addEventListener('change', ()=> {
        if (all.checked) {
            checkboxes.forEach((element) => {
                element.checked = true;
            });
        } else {
            checkboxes.forEach((element) => {
                element.checked = false;
            });
        }
    });

    checkboxes.forEach((element) => {
        // add and removes elements from array
        element.addEventListener('change', () => {
            if (element.checked) {
                alt.push(element.value);
                console.log(element.value);
            } else {
                let index = alt.indexOf(element.value);
                if (index >= 0) {
                    alt.splice( index, 1 );
                }
            }
        });
        // adds all checked values to array on page load
        if (element.checked) {
            alt.push(element.value);
        }
    });

    // function to randomize lunch
    function getLunch(alt, addToDom){
        const lenght = alt.length;
        let result = Math.floor(Math.random() * (lenght - 0)) + 0;
        btnRandomLunch.remove();
        reloadAlts.classList.remove("display-none");
        reloadAlts.className += " display";
        return addToDom.innerHTML = alt[result];
    }

    // starts getLunch function
    btnRandomLunch.addEventListener('click', event => {
        getLunch(alt, result);
    });

    // starts getLunch function
    reloadAlts.addEventListener('click', event => {
        getLunch(alt, result);
    });


</script>
</html>
